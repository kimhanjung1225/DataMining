## 예제 1) decision Tress모델과 Naïve Bayes모델의 오분류표를 비교하여라.

# 패키지 불러오기
library(rpart)
library(caret)
library(e1071)   # Naive Bayes

# 데이터 불러오기
data(iris)

# (1) Decision Tree 모델
dt_model <- rpart(Species ~ ., data = iris, method = "class")
dt_pred <- predict(dt_model, iris, type = "class")

# 혼동행렬 (Decision Tree)
cm_dt <- confusionMatrix(dt_pred, iris$Species)
cm_dt$table
cm_dt$overall['Accuracy']

# (2) Naïve Bayes 모델
nb_model <- naiveBayes(Species ~ ., data = iris)
nb_pred <- predict(nb_model, iris)

# 혼동행렬 (Naive Bayes)
cm_nb <- confusionMatrix(nb_pred, iris$Species)
cm_nb$table
cm_nb$overall['Accuracy']

# 결과 비교
cat("Decision Tree Accuracy:", cm_dt$overall['Accuracy'], "\n")
cat("Naive Bayes Accuracy:", cm_nb$overall['Accuracy'], "\n")


## 예제 2) data(spam)을 나이브베이즈 분류하고, klaR을 이용하여 시각화 하라.

url <- "https://cran.r-project.org/src/contrib/Archive/ElemStatLearn/ElemStatLearn_2015.6.26.2.tar.gz"
install.packages(url, repos = NULL, type = "source")
install.packages("ElemStatLearn")
library(ElemStatLearn)
data("spam")
str(spam)

##패키지 설치
#klaR의 NaiceBayes 사용 (e1071과 다름)
library(klaR)
train<-sample(1:nrow(spam), floor(nrow(spam)*0.6), replace = FALSE)
str(train)
m_klar <- NaiveBayes(spam~., data = spam[train, ])
#원하던 2x4 시각화
par(mfrow = c(2,4))
plot(m_klar)
par(mfrow = c(1,1))

## 예제 3) data(housevote)를 나이브베이즈 분류하라.

# 필요한 패키지 설치
install.packages("mlbench")   # housevote 데이터셋 포함
install.packages("klaR")      # NaiveBayes 함수
install.packages("caret")     # 데이터 분할

# 라이브러리 불러오기
library(mlbench)
library(klaR)
library(caret)

# 데이터 불러오기
data("HouseVotes84")
str(HouseVotes84)


# 데이터 분할 (train / test)
set.seed(123)
trainIndex <- createDataPartition(HouseVotes84$Class, p = 0.7, list = FALSE)
trainData <- HouseVotes84[trainIndex, ]
testData  <- HouseVotes84[-trainIndex, ]


# 나이브 베이즈 학습
nb_model <- NaiveBayes(Class ~ ., data = trainData)
print(nb_model)


# 예측 및 평가
pred <- predict(nb_model, testData)

# 혼동 행렬 확인
confusionMatrix(pred$class, testData$Class)